import re

def detect_vulnerabilities(sections: dict, skills: list, gaps: list) -> list:
    vulnerabilities = []

    projects_text = sections.get("projects", "")
    experience_text = sections.get("experience", "")

    # Rule 1: Education gap
    if gaps:
        for g in gaps:
            vulnerabilities.append(f"Education gap detected between {g[0]} and {g[1]}")

    # Rule 2: Many skills but less projects
    project_count = len([line for line in projects_text.split("\n") if line.strip()])
    if len(skills) >= 10 and project_count < 5:
        vulnerabilities.append("Many skills found but very few project details (depth risk).")

    # Rule 3: Internship/experience without numbers
    if experience_text.strip():
        has_metrics = bool(re.search(r"\b\d+%|\b\d+\s*(months|years)|\b\d+\b", experience_text.lower()))
        if not has_metrics:
            vulnerabilities.append("Experience mentioned but no measurable results/metrics found (impact missing).")

    # Rule 4: Missing GitHub links in projects
    if projects_text.strip() and "github" not in projects_text.lower():
        vulnerabilities.append("Projects listed but GitHub link not found.")

    return vulnerabilities
